---
- name: Configure Ansible defaults
  hosts: all

  tasks:
    - name: Ensure directory exists for ansible.cfg
      become: yes
      file:
        path: /etc/ansible
        state: directory

    - name: Create ansible.cfg file
      become: yes
      copy:
        content: |
          [defaults]
          become = True
          become_method = sudo
          become_user = root
        dest: /etc/ansible/ansible.cfg

    - name: Show ansible.cfg content
      command: cat /etc/ansible/ansible.cfg
      register: ansible_cfg_content

    - name: Display ansible.cfg content
      debug:
        msg: "{{ ansible_cfg_content.stdout }}"
